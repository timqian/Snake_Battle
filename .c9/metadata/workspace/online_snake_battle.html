{"filter":false,"title":"online_snake_battle.html","tooltip":"/online_snake_battle.html","undoManager":{"mark":32,"position":32,"stack":[[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":4,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":3,"column":30},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":3,"column":30},"action":"remove","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":3,"column":30},"action":"insert","lines":["《"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":3,"column":30},"action":"remove","lines":["《"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":3,"column":30},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":29},"end":{"row":4,"column":0},"action":"insert","lines":["",""]},{"start":{"row":4,"column":0},"end":{"row":4,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":0},"end":{"row":23,"column":3},"action":"remove","lines":["\t<script src=\"/socket.io/socket.io.js\"></script>","<!--\t","\t<script type=\"text/javascript\" src='drawer.js'></script>","-->"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":63},"end":{"row":20,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":31,"column":50},"end":{"row":31,"column":51},"action":"remove","lines":["8"]}]}],[{"group":"doc","deltas":[{"start":{"row":31,"column":49},"end":{"row":31,"column":50},"action":"remove","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":0},"end":{"row":154,"column":1},"action":"remove","lines":["/***********************************捕捉屏幕滑动*************************************/","\tvar localDir;  //本地捕捉到的方向","","\tvar xs=0,ys=0;  //在外面后面才能访问到","\twindow.addEventListener('touchstart', function(e) {","\t\txs = e.touches[0].clientX;","\t  ys = e.touches[0].clientY;","\t  //console.log(xs);","\t});","\twindow.addEventListener('touchmove', function(e) {","\t\tvar dx = e.changedTouches[0].clientX - xs;","\t  var dy = e.changedTouches[0].clientY - ys;","\t  //console.log(dx);","    if (dx < 0 & Math.abs(dx) > Math.abs(dy)) {","        localDir = 3;","    } else if(dx > 0 & Math.abs(dx) > Math.abs(dy)){","        localDir = 4;","    } else if(dy < 0 & Math.abs(dx) < Math.abs(dy)){","        localDir = 1;","    } else {","        localDir = 2;","    }","\t\t//根据是否snake1来判断localDir与哪条蛇方向不同时发送消息","\t\tif(isSnake1) {   ","\t\t\tif (localDir != snake1.dir) {","\t\t\t\tsocket.emit('dir', localDir);","\t\t\t}","\t\t}","\t\telse {","\t\t\tif (localDir != snake2.dir) {","\t\t\t\tsocket.emit('dir', localDir)","\t\t\t}","\t\t}","\t\t///////////////////////////////////////////////////","\t});","\tvar D = {97: 3, 115: 2, 100: 4, 119: 1}; ","\twindow.addEventListener('keypress', function (e) { //由按键改变direction ","\t\tif (D[e.which]) localDir = D[e.which]; ","\t\t//根据是否snake1来判断localDir与哪条蛇方向不同时发送消息","\t\tif(isSnake1) {   ","\t\t\tif (localDir != snake1.dir) {","\t\t\t\tsocket.emit('dir', localDir);","\t\t\t}","\t\t}","\t\telse {","\t\t\tif (localDir != snake2.dir) {","\t\t\t\tsocket.emit('dir', localDir)","\t\t\t}","\t\t}","\t\t///////////////////////////////////////////////////","\t}); ","///////////////////////////////////////////////////////////////////////////////////////","\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":76,"column":0},"end":{"row":101,"column":0},"action":"remove","lines":["socket.on('start', function(){","\ttid = setTimeout(gloop, 200);","});","","socket.on('dir', function(data) {  //接受服务端dir","\tconsole.log(data);","\tif (isSnake1){","\t\tsnake1.dir = data[0]; snake2.dir = data[1];","\t} else {","\t\tsnake1.dir = data[0];snake2.dir = data[1];","\t}","});","","/*","if (isSnake1) {","\tsnake1.dir = remoteDir[0];","\tsnake2.dir = remoteDir[1];","}","else {","\tsnake1.dir = remoteDir[0];","\tsnake2.dir = remoteDir[1];","}*/","","/////////////////////////////////////////////////////////////////////////","",""]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":2},"end":{"row":81,"column":3},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":3},"end":{"row":81,"column":4},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":3},"end":{"row":81,"column":4},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":2},"end":{"row":81,"column":3},"action":"remove","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":2},"end":{"row":81,"column":3},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":3},"end":{"row":81,"column":4},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":4},"end":{"row":81,"column":5},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":81,"column":5},"end":{"row":81,"column":6},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":0},"end":{"row":77,"column":0},"action":"remove","lines":["/*接受server消息，改变snake的方向*********************************************************/","","var socket = io();","","var isSnake1 = false;","","socket.on('snake1', function(){","\tconsole.log('i am snake1');","\tisSnake1 = true;","});","","","var tid;","",""]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":0},"end":{"row":63,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":67,"column":2},"end":{"row":68,"column":0},"action":"insert","lines":["",""]},{"start":{"row":68,"column":0},"end":{"row":68,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":66,"column":2},"end":{"row":66,"column":6},"action":"remove","lines":["var "]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":1},"end":{"row":68,"column":5},"action":"insert","lines":["var "]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":5},"end":{"row":68,"column":6},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":6},"end":{"row":68,"column":7},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":7},"end":{"row":68,"column":8},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":8},"end":{"row":68,"column":9},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":9},"end":{"row":68,"column":10},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":10},"end":{"row":68,"column":11},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":11},"end":{"row":68,"column":34},"action":"insert","lines":["setTimeout(gloop, 200);"]}]}]]},"ace":{"folds":[],"scrolltop":381,"scrollleft":0,"selection":{"start":{"row":60,"column":2},"end":{"row":60,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":26,"state":"js-comment_regex_allowed","mode":"ace/mode/html"}},"timestamp":1426851587000,"hash":"bc83a6f6a916627c162523643b0e760c51beba71"}